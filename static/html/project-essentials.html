<!--Panel-->
<div class="panel panel-default tile has-fullscreen-toggle" ng-controller="ProjectEssentialsCtrl as cm">
    <div class="panel-heading">
        <h3 class="text-center">
            <span class="fa fa-book"></span>
            Essentials
        </h3>
    </div>

    <div class="panel-body">
        <!--Form-->
        <form name="cm.form">
            <!--Reasons-->
            <div class="form-group">
                <label for="es-reason" class="control-label">Please describe the reasons for this project evaluation:</label>
                        <textarea id="es-reason" class="form-control vert"
                                placeholder="Example: There's a strong need to add an extra 10TB storage to the company's backup server."
                                ng-model="cm.project.notes.reasons"
                                ng-blur="cm.patchProject()"
                                ps-focus-on="cm.focusField === 'reasons'"
                                ></textarea>
            </div>
            <!--Category-->
            <div class="form-group">
                <label class="control-label">Select category:</label>
                <ui-select ng-model="cm.category.selected" theme="bootstrap"
                        tagging="cm.addCategory"
                        tagging-tokens="ENTER"
                        tagging-label="(adding new)"
                        on-select="cm.selectCategory($model)"
                        ps-focus-on="cm.focusField === 'category'">
                    <!--Label don't work-->
                    <ui-select-match placeholder="Select or search a category or domain...">
                        {{ $select.selected.name }}
                        <span class="fa fa-check"></span>
                    </ui-select-match>
                    <ui-select-choices repeat="category in cm.categories | filter: $select.search track by category.name"
                            group-by="cm.groupByCategory">
                        <span ng-bind-html="category.name | highlight: $select.search"></span>
                        <span ng-if="category.name == cm.category.selected.name" class="fa fa-check"></span>
                                <span ng-if="category.custom" class="delete-category"
                                        ng-click="cm.deleteCategory(category)">
                                    <span class="fa fa-trash"></span> <span class="link">Delete</span>
                                </span>
                    </ui-select-choices>
                </ui-select>
            </div>
            <!--Goals-->
            <div class="form-group">
                <label for="es-goal" class="control-label">What are the project goals?</label>
                        <textarea id="es-goal" class="form-control vert"
                                placeholder="Example: The new backup system should extend the current 6TB transparently."
                                ng-model="cm.project.notes.goals"
                                ng-blur="cm.patchProject()"
                                ps-focus-on="cm.focusField === 'goals'"
                                ></textarea>
            </div>

            <div class="form-horizontal">
                <!--Budget-->
                <div class="form-group">
                    <label for="es-budget" class="col-sm-2 control-label left">Budget:</label>
                    <div class="col-sm-10">
                        <div class="input-group" ng-class="{'has-error': cm.form.esBudget.$invalid}">
                            <!--Currency Select-->
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-default dropdown-toggle"
                                        data-toggle="dropdown" aria-expanded="false">
                                    <span class="fa fa-fw fa-{{ cm.project.budget.currencyLabel | lowercase }}"></span>
                                    {{ cm.project.budget.currencyLabel }}
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu" role="menu">
                                    <li ng-repeat="currency in cm.currencyLabels"
                                            ng-class="{active: (currency === cm.project.budget.currencyLabel)}">
                                        <a href ng-click="cm.selectCurrency(currency)">
                                            <span class="fa fa-{{:: currency | lowercase}}"></span>
                                            {{:: currency }}
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <input type="number" id="es-budget" name="esBudget" class="form-control"
                                    min="0"
                                    ng-model="cm.project.budget.amount"
                                    ng-blur="cm.saveNumber(cm.project.budget, 'amount',  cm.form.esBudget.$invalid)"
                                    ps-focus-on="cm.focusField === 'budget'"
                                    />
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-default dropdown-toggle"
                                        data-toggle="dropdown" aria-expanded="false">
                                    {{ cm.project.budget.amountMultiplier }}
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu dropdown-menu-right" role="menu">
                                    <li ng-repeat="mul in cm.amountMultipliers"
                                            ng-class="{active: (mul === cm.project.budget.amountMultiplier)}">
                                        <a href ng-click="cm.selectMultiplier(mul)">{{:: mul }}</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Resources-->
                <div class="form-group">
                    <label for="es-resource" class="col-sm-2 control-label left">Resources:</label>
                    <div class="col-sm-10">
                        <input id="es-resource" type="text" class="form-control"
                                placeholder="Example: 2 employees part time for 2 months"
                                ng-model="cm.project.notes.resources"
                                ng-blur="cm.patchProject()"
                                ps-focus-on="cm.focusField === 'resources'"
                                />
                    </div>
                </div>
            </div>

            <div class="row">
                <!--Col #1: Start Date-->
                <div class="col-sm-6 form-horizontal">
                    <div class="form-group">
                        <label for="es-start-date" class="col-sm-4 control-label text-nowrap left">Due date:</label>
                        <div class="col-sm-8">
                            <div class="input-group date">
                                <input id="es-start-date" type="text" class="form-control"
                                        placeholder="MM/dd/yyyy"
                                        ng-model="cm.project.time.startDate"
                                        ps-date-picker
                                        ng-blur="cm.patchProject()"
                                        ps-focus-on="cm.focusField === 'startDate'"/>
                                <span class="input-group-addon btn last"><span class="fa fa-calendar"></span></span>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Col #2: Duration-->
                <div class="col-sm-6 form-horizontal">
                    <div class="form-group">
                        <label for="es-duration" class="col-sm-4 control-label">Duration:</label>
                        <div class="col-sm-8">
                            <div class="input-group" ng-class="{'has-error': cm.form.esDuration.$invalid}">
                                <input type="number" id="es-duration" name="esDuration" class="form-control"
                                        min="0"
                                        ng-model="cm.project.time.duration"
                                        ng-blur="cm.saveNumber(cm.project.time, 'duration', cm.form.esDuration.$invalid)"
                                        ps-focus-on="cm.focusField === 'duration'"
                                        />
                                <!--Label Select-->
                                <div class="input-group-btn dropup">
                                    <button type="button" class="btn btn-default dropdown-toggle"
                                            data-toggle="dropdown" aria-expanded="false">
                                        {{ cm.project.time.durationLabel }}
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                                        <li ng-repeat="label in cm.durationLabels"
                                                ng-class="{active: (label === cm.project.time.durationLabel)}">
                                            <a href ng-click="cm.selectDurationLabel(label)">
                                                {{:: label }}
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </form>

        <!--Done link-->
        <a class="btn btn-primary pull-right" ui-sref="^.decisions">Done</a>
    </div>
</div>
